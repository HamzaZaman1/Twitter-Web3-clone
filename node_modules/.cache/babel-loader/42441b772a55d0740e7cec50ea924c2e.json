{"ast":null,"code":"import _asyncToGenerator from\"D:/Projects/Twitter web3 clone/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"D:/Projects/Twitter web3 clone/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"D:\\\\Projects\\\\Twitter web3 clone\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React from\"react\";import\"./Home.css\";import{defaultImgs}from\"../defaulttimgs\";import{TextArea,Icon}from\"web3uikit\";import{useState,useRef}from\"react\";import TweetInFeed from\"../components/TweetInFeed\";import{useMoralis,useWeb3ExecuteFunction}from\"react-moralis\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Home=function Home(){var _useMoralis=useMoralis(),Moralis=_useMoralis.Moralis;var user=Moralis.User.current();var contractProcessor=useWeb3ExecuteFunction();var inputFile=useRef(null);var _useState=useState(),_useState2=_slicedToArray(_useState,2),selectedFile=_useState2[0],setSelectedFile=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),theFile=_useState4[0],setTheFile=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),tweet=_useState6[0],setTweet=_useState6[1];function maticTweet(){return _maticTweet.apply(this,arguments);}function _maticTweet(){_maticTweet=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var img,data,file,options;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(tweet){_context.next=2;break;}return _context.abrupt(\"return\");case 2:if(!theFile){_context.next=10;break;}data=theFile;file=new Moralis.File(data.name,data);_context.next=7;return file.saveIPFS();case 7:img=file.ipfs();_context.next=11;break;case 10:img=\"No Img\";case 11:options={contractAddress:\"0xd9145CCE52D386f254917e481eB44e9943F39138\",functionName:\"addTweet\",abi:[{inputs:[{internalType:\"string\",name:\"tweetTxt\",type:\"string\"},{internalType:\"string\",name:\"tweetImg\",type:\"string\"}],name:\"addTweet\",outputs:[],stateMutability:\"payable\",type:\"function\"}],params:{tweetTxt:tweet,tweetImg:img},msgValue:Moralis.Units.ETH(1)};_context.next=14;return contractProcessor.fetch({params:options,onSuccess:function onSuccess(){saveTweet();},onError:function onError(error){console.log(error.data.message);}});case 14:case\"end\":return _context.stop();}}},_callee);}));return _maticTweet.apply(this,arguments);}function saveTweet(){return _saveTweet.apply(this,arguments);}function _saveTweet(){_saveTweet=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var Tweets,newTweet,data,file;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(tweet){_context2.next=2;break;}return _context2.abrupt(\"return\");case 2:Tweets=Moralis.Object.extend(\"Tweets\");newTweet=new Tweets();newTweet.set(\"tweetTxt\",tweet);newTweet.set(\"tweeterPfp\",user.attributes.pfp);newTweet.set(\"tweeterAcc\",user.attributes.ethAddress);newTweet.set(\"tweeterUserName\",user.attributes.username);if(!theFile){_context2.next=14;break;}data=theFile;file=new Moralis.File(data.name,data);_context2.next=13;return file.saveIPFS();case 13:newTweet.set(\"tweetImg\",file.ipfs());case 14:_context2.next=16;return newTweet.save();case 16:window.location.reload();case 17:case\"end\":return _context2.stop();}}},_callee2);}));return _saveTweet.apply(this,arguments);}var onImageClick=function onImageClick(){inputFile.current.click();};var changeHandler=function changeHandler(event){var img=event.target.files[0];setTheFile(img);setSelectedFile(URL.createObjectURL(img));};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"pageIdentify\",children:\"Home\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mainContent\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"profileTweet\",children:[/*#__PURE__*/_jsx(\"img\",{src:user.attributes.pfp?user.attributes.pfp:defaultImgs[0],className:\"profilePic\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"tweetBox\",children:[/*#__PURE__*/_jsx(TextArea,{label:\"\",name:\"tweetTxtArea\",value:\"GM World\",type:\"text\",onChange:function onChange(e){return setTweet(e.target.value);},width:\"95%\"}),selectedFile&&/*#__PURE__*/_jsx(\"img\",{src:selectedFile,className:\"tweetImg\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"imgOrTweet\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"imgDiv\",onClick:onImageClick,children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",name:\"file\",ref:inputFile,onChange:changeHandler,style:{display:\"none\"}}),/*#__PURE__*/_jsx(Icon,{fill:\"#1DA1F2\",size:20,svg:\"image\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"tweetOptions\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"tweet\",onClick:saveTweet,children:\"Tweet\"}),/*#__PURE__*/_jsx(\"div\",{className:\"tweet\",onClick:maticTweet,style:{backgroundColor:\"#8247e5\"},children:/*#__PURE__*/_jsx(Icon,{fill:\"#ffffff\",size:20,svg:\"matic\"})})]})]})]})]}),/*#__PURE__*/_jsx(TweetInFeed,{profile:false})]})]});};export default Home;","map":{"version":3,"sources":["D:/Projects/Twitter web3 clone/src/pages/Home.js"],"names":["React","defaultImgs","TextArea","Icon","useState","useRef","TweetInFeed","useMoralis","useWeb3ExecuteFunction","Home","Moralis","user","User","current","contractProcessor","inputFile","selectedFile","setSelectedFile","theFile","setTheFile","tweet","setTweet","maticTweet","data","file","File","name","saveIPFS","img","ipfs","options","contractAddress","functionName","abi","inputs","internalType","type","outputs","stateMutability","params","tweetTxt","tweetImg","msgValue","Units","ETH","fetch","onSuccess","saveTweet","onError","error","console","log","message","Tweets","Object","extend","newTweet","set","attributes","pfp","ethAddress","username","save","window","location","reload","onImageClick","click","changeHandler","event","target","files","URL","createObjectURL","e","value","display","backgroundColor"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport \"./Home.css\";\r\nimport { defaultImgs } from \"../defaulttimgs\";\r\nimport { TextArea, Icon } from \"web3uikit\";\r\nimport { useState, useRef } from \"react\";\r\nimport TweetInFeed from \"../components/TweetInFeed\";\r\nimport { useMoralis, useWeb3ExecuteFunction } from \"react-moralis\";\r\n\r\nconst Home = () => {\r\n  const { Moralis } = useMoralis();\r\n  const user = Moralis.User.current();\r\n  const contractProcessor = useWeb3ExecuteFunction();\r\n\r\n  const inputFile = useRef(null);\r\n  const [selectedFile, setSelectedFile] = useState();\r\n  const [theFile, setTheFile] = useState();\r\n  const [tweet, setTweet] = useState();\r\n\r\n  async function maticTweet() {\r\n    if (!tweet) return;\r\n\r\n    let img;\r\n    if (theFile) {\r\n      const data = theFile;\r\n      const file = new Moralis.File(data.name, data);\r\n      await file.saveIPFS();\r\n      img = file.ipfs();\r\n    } else {\r\n      img = \"No Img\";\r\n    }\r\n\r\n    let options = {\r\n      contractAddress: \"0xd9145CCE52D386f254917e481eB44e9943F39138\",\r\n      functionName: \"addTweet\",\r\n      abi: [\r\n        {\r\n          inputs: [\r\n            {\r\n              internalType: \"string\",\r\n              name: \"tweetTxt\",\r\n              type: \"string\",\r\n            },\r\n            {\r\n              internalType: \"string\",\r\n              name: \"tweetImg\",\r\n              type: \"string\",\r\n            },\r\n          ],\r\n          name: \"addTweet\",\r\n          outputs: [],\r\n          stateMutability: \"payable\",\r\n          type: \"function\",\r\n        },\r\n      ],\r\n      params: {\r\n        tweetTxt: tweet,\r\n        tweetImg: img,\r\n      },\r\n      msgValue: Moralis.Units.ETH(1),\r\n    };\r\n\r\n    await contractProcessor.fetch({\r\n      params: options,\r\n      onSuccess: () => {\r\n        saveTweet();\r\n      },\r\n      onError: (error) => {\r\n        console.log(error.data.message);\r\n      },\r\n    });\r\n  }\r\n\r\n  async function saveTweet() {\r\n    if (!tweet) return;\r\n\r\n    const Tweets = Moralis.Object.extend(\"Tweets\");\r\n\r\n    const newTweet = new Tweets();\r\n\r\n    newTweet.set(\"tweetTxt\", tweet);\r\n    newTweet.set(\"tweeterPfp\", user.attributes.pfp);\r\n    newTweet.set(\"tweeterAcc\", user.attributes.ethAddress);\r\n    newTweet.set(\"tweeterUserName\", user.attributes.username);\r\n\r\n    if (theFile) {\r\n      const data = theFile;\r\n      const file = new Moralis.File(data.name, data);\r\n      await file.saveIPFS();\r\n      newTweet.set(\"tweetImg\", file.ipfs());\r\n    }\r\n\r\n    await newTweet.save();\r\n    window.location.reload();\r\n  }\r\n\r\n  const onImageClick = () => {\r\n    inputFile.current.click();\r\n  };\r\n\r\n  const changeHandler = (event) => {\r\n    const img = event.target.files[0];\r\n    setTheFile(img);\r\n    setSelectedFile(URL.createObjectURL(img));\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <div className=\"pageIdentify\">Home</div>\r\n      <div className=\"mainContent\">\r\n        <div className=\"profileTweet\">\r\n          <img\r\n            src={user.attributes.pfp ? user.attributes.pfp : defaultImgs[0]}\r\n            className=\"profilePic\"\r\n          ></img>\r\n          <div className=\"tweetBox\">\r\n            <TextArea\r\n              label=\"\"\r\n              name=\"tweetTxtArea\"\r\n              value=\"GM World\"\r\n              type=\"text\"\r\n              onChange={(e) => setTweet(e.target.value)}\r\n              width=\"95%\"\r\n            ></TextArea>\r\n            {selectedFile && (\r\n              <img src={selectedFile} className=\"tweetImg\"></img>\r\n            )}\r\n            <div className=\"imgOrTweet\">\r\n              <div className=\"imgDiv\" onClick={onImageClick}>\r\n                <input\r\n                  type=\"file\"\r\n                  name=\"file\"\r\n                  ref={inputFile}\r\n                  onChange={changeHandler}\r\n                  style={{ display: \"none\" }}\r\n                />\r\n                <Icon fill=\"#1DA1F2\" size={20} svg=\"image\"></Icon>\r\n              </div>\r\n              <div className=\"tweetOptions\">\r\n                <div className=\"tweet\" onClick={saveTweet}>\r\n                  Tweet\r\n                </div>\r\n                <div\r\n                  className=\"tweet\"\r\n                  onClick={maticTweet}\r\n                  style={{ backgroundColor: \"#8247e5\" }}\r\n                >\r\n                  <Icon fill=\"#ffffff\" size={20} svg=\"matic\" />\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <TweetInFeed profile={false} />\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Home;\r\n"]},"metadata":{},"sourceType":"module"}